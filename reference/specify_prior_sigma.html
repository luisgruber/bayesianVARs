<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Specify prior on Sigma — specify_prior_sigma • bayesianVARs</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specify prior on Sigma — specify_prior_sigma"><meta name="description" content="Configures prior on the variance-covariance of the VAR."><meta property="og:description" content="Configures prior on the variance-covariance of the VAR."><meta property="og:image" content="https://luisgruber.github.io/bayesianVARs/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bayesianVARs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bayesianVARs-vignette.pdf">Shrinkage Priors for Bayesian Vectorautoregressions featuring Stochastic Volatility Using the **R** Package **bayesianVARs** (PDF)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/luisgruber/bayesianVARs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Specify prior on Sigma</h1>
      <small class="dont-index">Source: <a href="https://github.com/luisgruber/bayesianVARs/blob/v0.1.4/R/utility_functions.R" class="external-link"><code>R/utility_functions.R</code></a></small>
      <div class="d-none name"><code>specify_prior_sigma.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Configures prior on the variance-covariance of the VAR.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">specify_prior_sigma</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor"</span>, <span class="st">"cholesky"</span><span class="op">)</span>,</span>
<span>  factor_factors <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  factor_restrict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"upper"</span><span class="op">)</span>,</span>
<span>  factor_priorfacloadtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowwiseng"</span>, <span class="st">"colwiseng"</span>, <span class="st">"normal"</span><span class="op">)</span>,</span>
<span>  factor_priorfacload <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  factor_facloadtol <span class="op">=</span> <span class="fl">1e-18</span>,</span>
<span>  factor_priorng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  factor_priormu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  factor_priorphiidi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  factor_priorphifac <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  factor_priorsigmaidi <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  factor_priorsigmafac <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  factor_priorh0idi <span class="op">=</span> <span class="st">"stationary"</span>,</span>
<span>  factor_priorh0fac <span class="op">=</span> <span class="st">"stationary"</span>,</span>
<span>  factor_heteroskedastic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  factor_priorhomoskedastic <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  factor_interweaving <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cholesky_U_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HS"</span>, <span class="st">"DL"</span>, <span class="st">"R2D2"</span>, <span class="st">"NG"</span>, <span class="st">"SSVS"</span>, <span class="st">"normal"</span>, <span class="st">"HMP"</span><span class="op">)</span>,</span>
<span>  cholesky_U_tol <span class="op">=</span> <span class="fl">1e-18</span>,</span>
<span>  cholesky_heteroscedastic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cholesky_priormu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  cholesky_priorphi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  cholesky_priorsigma2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  cholesky_priorh0 <span class="op">=</span> <span class="st">"stationary"</span>,</span>
<span>  cholesky_priorhomoscedastic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  cholesky_DL_a <span class="op">=</span> <span class="st">"1/n"</span>,</span>
<span>  cholesky_DL_tol <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cholesky_R2D2_a <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  cholesky_R2D2_b <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  cholesky_R2D2_tol <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cholesky_NG_a <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  cholesky_NG_b <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  cholesky_NG_c <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  cholesky_NG_tol <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cholesky_SSVS_c0 <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  cholesky_SSVS_c1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cholesky_SSVS_p <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  cholesky_HMP_lambda3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  cholesky_normal_sds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  expert_sv_offset <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Optional. Data matrix (can be a time series object). Each of
\(M\) columns is assumed to contain a single time-series of length
\(T\).</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>positive integer indicating the number of time-series of the VAR.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>character, one of <code>"factor"</code> (the default) or <code>"cholesky"</code>,
indicating which decomposition to be applied to the covariance-matrix.</p></dd>


<dt id="arg-factor-factors">factor_factors<a class="anchor" aria-label="anchor" href="#arg-factor-factors"></a></dt>
<dd><p>Number of latent factors to be estimated. Only required
if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-restrict">factor_restrict<a class="anchor" aria-label="anchor" href="#arg-factor-restrict"></a></dt>
<dd><p>Either "upper" or "none", indicating whether the factor
loadings matrix should be restricted to have zeros above the diagonal
("upper") or whether all elements should be estimated from the data
("none"). Setting <code>restrict</code> to "upper" often stabilizes MCMC
estimation and can be important for identifying the factor loadings matrix,
however, it generally is a strong prior assumption. Setting <code>restrict</code>
to "none" is usually the preferred option if identification of the factor
loadings matrix is of less concern but covariance estimation or prediction
is the goal. Only required if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-priorfacloadtype">factor_priorfacloadtype<a class="anchor" aria-label="anchor" href="#arg-factor-priorfacloadtype"></a></dt>
<dd><p>Can be <code>"normal"</code>, <code>"rowwiseng"</code>,
<code>"colwiseng"</code>. Only required if <code>type="factor"</code>.</p><dl><dt><code>"normal"</code>: </dt>
<dd><p>Normal prior. The value of <code>priorfacload</code>
is interpreted as the standard deviations of the
Gaussian prior distributions for the factor loadings.</p></dd>

<dt><code>"rowwiseng"</code>: </dt>
<dd><p>Row-wise Normal-Gamma prior. The value of <code>priorfacload</code>
is interpreted as the shrinkage parameter <code>a</code>.</p></dd>

<dt><code>"colwiseng"</code>: </dt>
<dd><p>Column-wise Normal-Gamma prior. The value of <code>priorfacload</code>
is interpreted as the shrinkage parameter <code>a</code>.</p></dd>


</dl><p>For details please see Kastner (2019).</p></dd>


<dt id="arg-factor-priorfacload">factor_priorfacload<a class="anchor" aria-label="anchor" href="#arg-factor-priorfacload"></a></dt>
<dd><p>Either a matrix of dimensions <code>M</code> times
<code>factor_factors</code> with positive elements or a single number (which will
be recycled accordingly). Only required if <code>type="factor"</code>. The meaning of
<code>factor_priorfacload</code> depends on the setting of
<code>factor_priorfacloadtype</code> and is explained there.</p></dd>


<dt id="arg-factor-facloadtol">factor_facloadtol<a class="anchor" aria-label="anchor" href="#arg-factor-facloadtol"></a></dt>
<dd><p>Minimum number that the absolute value of a factor
loadings draw can take. Prevents numerical issues that can appear when
strong shrinkage is enforced if chosen to be greater than zero. Only
required if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-priorng">factor_priorng<a class="anchor" aria-label="anchor" href="#arg-factor-priorng"></a></dt>
<dd><p>Two-element vector with positive entries indicating the
Normal-Gamma prior's hyperhyperparameters <code>c</code> and <code>d</code> (cf. Kastner
(2019)). Only required if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-priormu">factor_priormu<a class="anchor" aria-label="anchor" href="#arg-factor-priormu"></a></dt>
<dd><p>Vector of length 2 denoting prior mean and standard
deviation for unconditional levels of the idiosyncratic log variance
processes. Only required if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-priorphiidi">factor_priorphiidi<a class="anchor" aria-label="anchor" href="#arg-factor-priorphiidi"></a></dt>
<dd><p>Vector of length 2, indicating the shape parameters
for the Beta prior distributions of the transformed parameters
<code>(phi+1)/2</code>, where <code>phi</code> denotes the persistence of the
idiosyncratic log variances. Only required if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-priorphifac">factor_priorphifac<a class="anchor" aria-label="anchor" href="#arg-factor-priorphifac"></a></dt>
<dd><p>Vector of length 2, indicating the shape parameters
for the Beta prior distributions of the transformed parameters
<code>(phi+1)/2</code>, where <code>phi</code> denotes the persistence of the factor log
variances. Only required if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-priorsigmaidi">factor_priorsigmaidi<a class="anchor" aria-label="anchor" href="#arg-factor-priorsigmaidi"></a></dt>
<dd><p>Vector of length <code>M</code> containing the prior
volatilities of log variances. If <code>factor_priorsigmaidi</code> has exactly
one element, it will be recycled for all idiosyncratic log variances. Only
required if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-priorsigmafac">factor_priorsigmafac<a class="anchor" aria-label="anchor" href="#arg-factor-priorsigmafac"></a></dt>
<dd><p>Vector of length <code>factor_factors</code> containing
the prior volatilities of log variances. If <code>factor_priorsigmafac</code> has
exactly one element, it will be recycled for all factor log variances. Only
required if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-priorh-idi">factor_priorh0idi<a class="anchor" aria-label="anchor" href="#arg-factor-priorh-idi"></a></dt>
<dd><p>Vector of length 1 or <code>M</code>, containing
information about the Gaussian prior for the initial idiosyncratic log
variances. Only required if <code>type="factor"</code>. If an element of
<code>factor_priorh0idi</code> is a nonnegative number, the conditional prior of
the corresponding initial log variance h0 is assumed to be Gaussian with
mean 0 and standard deviation <code>factor_priorh0idi</code> times \(sigma\). If
an element of <code>factor_priorh0idi</code> is the string 'stationary', the prior
of the corresponding initial log volatility is taken to be from the
stationary distribution, i.e. h0 is assumed to be Gaussian with mean 0 and
variance \(sigma^2/(1-phi^2)\).</p></dd>


<dt id="arg-factor-priorh-fac">factor_priorh0fac<a class="anchor" aria-label="anchor" href="#arg-factor-priorh-fac"></a></dt>
<dd><p>Vector of length 1 or <code>factor_factors</code>,
containing information about the Gaussian prior for the initial factor log
variances. Only required if <code>type="factor"</code>. If an element of
<code>factor_priorh0fac</code> is a nonnegative number, the conditional prior of
the corresponding initial log variance h0 is assumed to be Gaussian with
mean 0 and standard deviation <code>factor_priorh0fac</code> times \(sigma\). If
an element of <code>factor_priorh0fac</code> is the string 'stationary', the prior
of the corresponding initial log volatility is taken to be from the
stationary distribution, i.e. h0 is assumed to be Gaussian with mean 0 and
variance \(sigma^2/(1-phi^2)\).</p></dd>


<dt id="arg-factor-heteroskedastic">factor_heteroskedastic<a class="anchor" aria-label="anchor" href="#arg-factor-heteroskedastic"></a></dt>
<dd><p>Vector of length 1, 2, or <code>M +
 factor_factors</code>, containing logical values indicating whether time-varying
(<code>factor_heteroskedastic = TRUE</code>) or constant (<code>factor_heteroskedastic =
  FALSE</code>) variance should be estimated. If <code>factor_heteroskedastic</code> is of
length 2 it will be recycled accordingly, whereby the first element is used
for all idiosyncratic variances and the second element is used for all
factor variances. Only required if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-priorhomoskedastic">factor_priorhomoskedastic<a class="anchor" aria-label="anchor" href="#arg-factor-priorhomoskedastic"></a></dt>
<dd><p>Only used if at least one element of
<code>factor_heteroskedastic</code> is set to <code>FALSE</code>. In that case,
<code>factor_priorhomoskedastic</code> must be a matrix with positive entries and
dimension c(M, 2). Values in column 1 will be interpreted as the shape and
values in column 2 will be interpreted as the rate parameter of the
corresponding inverse gamma prior distribution of the idiosyncratic
variances. Only required if <code>type="factor"</code>.</p></dd>


<dt id="arg-factor-interweaving">factor_interweaving<a class="anchor" aria-label="anchor" href="#arg-factor-interweaving"></a></dt>
<dd><p>The following values for interweaving the factor
loadings are accepted (Only required if <code>type="factor"</code>):</p><dl><dt>0: </dt>
<dd><p>No interweaving.</p></dd>

<dt>1: </dt>
<dd><p>Shallow interweaving through the diagonal entries.</p></dd>

<dt>2: </dt>
<dd><p>Deep interweaving through the diagonal entries.</p></dd>

<dt>3: </dt>
<dd><p>Shallow interweaving through the largest absolute entries in each column.</p></dd>

<dt>4: </dt>
<dd><p>Deep interweaving through the largest absolute entries in each column.</p></dd>


</dl><p>For details please see Kastner et al. (2017). A value of 4 is the highly
recommended default.</p></dd>


<dt id="arg-cholesky-u-prior">cholesky_U_prior<a class="anchor" aria-label="anchor" href="#arg-cholesky-u-prior"></a></dt>
<dd><p>character, one of <code>"HS"</code>, <code>"R2D2"</code>, <code>"NG"</code>,
<code>"DL"</code>, <code>"SSVS"</code>, <code>"HMP"</code> or <code>"normal"</code>. Only required
if <code>type="cholesky"</code>.</p></dd>


<dt id="arg-cholesky-u-tol">cholesky_U_tol<a class="anchor" aria-label="anchor" href="#arg-cholesky-u-tol"></a></dt>
<dd><p>Minimum number that the absolute value of an free
off-diagonal element of an \(U\)-draw can take. Prevents numerical issues
that can appear when strong shrinkage is enforced if chosen to be greater
than zero. Only required if <code>type="cholesky"</code>.</p></dd>


<dt id="arg-cholesky-heteroscedastic">cholesky_heteroscedastic<a class="anchor" aria-label="anchor" href="#arg-cholesky-heteroscedastic"></a></dt>
<dd><p>single logical indicating whether time-varying
(<code>cholesky_heteroscedastic = TRUE</code>) or constant
(<code>cholesky_heteroscedastic = FALSE</code>) variance should be estimated. Only
required if <code>type="cholesky"</code>.</p></dd>


<dt id="arg-cholesky-priormu">cholesky_priormu<a class="anchor" aria-label="anchor" href="#arg-cholesky-priormu"></a></dt>
<dd><p>Vector of length 2 denoting prior mean and standard
deviation for unconditional levels of the log variance processes. Only
required if <code>type="cholesky"</code>.</p></dd>


<dt id="arg-cholesky-priorphi">cholesky_priorphi<a class="anchor" aria-label="anchor" href="#arg-cholesky-priorphi"></a></dt>
<dd><p>Vector of length 2, indicating the shape parameters
for the Beta prior distributions of the transformed parameters
<code>(phi+1)/2</code>, where <code>phi</code> denotes the persistence of the log
variances. Only required if <code>type="cholesky"</code>.</p></dd>


<dt id="arg-cholesky-priorsigma-">cholesky_priorsigma2<a class="anchor" aria-label="anchor" href="#arg-cholesky-priorsigma-"></a></dt>
<dd><p>Vector of length 2, indicating the shape and the
rate for the Gamma prior distributions on the variance of the log variance
processes. (Currently only one global setting for all \(M\) processes is
supported). Only required if <code>type="cholesky"</code>.</p></dd>


<dt id="arg-cholesky-priorh-">cholesky_priorh0<a class="anchor" aria-label="anchor" href="#arg-cholesky-priorh-"></a></dt>
<dd><p>Vector of length 1 or <code>M</code>, containing information
about the Gaussian prior for the initial idiosyncratic log variances. Only
required if <code>type="cholesky"</code>. If an element of <code>cholesky_priorh0</code> is a
nonnegative number, the conditional prior of the corresponding initial log
variance h0 is assumed to be Gaussian with mean 0 and standard deviation
<code>cholesky_priorh0</code> times \(sigma\). If an element of
<code>cholesky_priorh0</code> is the string 'stationary', the prior of the
corresponding initial log volatility is taken to be from the stationary
distribution, i.e. h0 is assumed to be Gaussian with mean 0 and variance
\(sigma^2/(1-phi^2)\).</p></dd>


<dt id="arg-cholesky-priorhomoscedastic">cholesky_priorhomoscedastic<a class="anchor" aria-label="anchor" href="#arg-cholesky-priorhomoscedastic"></a></dt>
<dd><p>Only used if
<code>cholesky_heteroscedastic=FALSE</code>. In that case,
<code>cholesky_priorhomoscedastic</code> must be a matrix with positive entries
and dimension c(M, 2). Values in column 1 will be interpreted as the shape
and values in column 2 will be interpreted as the scale parameter of the
corresponding inverse gamma prior distribution of the variances. Only
required if <code>type="cholesky"</code>.</p></dd>


<dt id="arg-cholesky-dl-a">cholesky_DL_a<a class="anchor" aria-label="anchor" href="#arg-cholesky-dl-a"></a></dt>
<dd><p>(Single) positive real number. The value is interpreted
as the concentration parameter for the local scales. Smaller values enforce
heavier shrinkage. A matrix of dimension <code>c(s,2)</code> specifies a discrete
hyperprior, where the first column contains s support points and the second
column contains the associated prior probabilities. <code>cholesky_DL_a</code> has only
to be specified if <code>cholesky_U_prior="DL"</code>.</p></dd>


<dt id="arg-cholesky-dl-tol">cholesky_DL_tol<a class="anchor" aria-label="anchor" href="#arg-cholesky-dl-tol"></a></dt>
<dd><p>Minimum number that a parameter draw of one of the
shrinking parameters of the Dirichlet Laplace prior can take. Prevents
numerical issues that can appear when strong shrinkage is enforced if chosen
to be greater than zero. <code>DL_tol</code> has only to be specified if
<code>cholesky_U_prior="DL"</code>.</p></dd>


<dt id="arg-cholesky-r-d-a">cholesky_R2D2_a<a class="anchor" aria-label="anchor" href="#arg-cholesky-r-d-a"></a></dt>
<dd><p>(Single) positive real number. The value is interpreted
as the concentration parameter for the local scales. Smaller values enforce
heavier shrinkage. A matrix of dimension <code>c(s,2)</code> specifies a discrete
hyperprior, where the first column contains s support points and the second
column contains the associated prior probabilities. cholesky_R2D2_a has only
to be specified if <code>cholesky_U_prior="R2D2"</code>.</p></dd>


<dt id="arg-cholesky-r-d-b">cholesky_R2D2_b<a class="anchor" aria-label="anchor" href="#arg-cholesky-r-d-b"></a></dt>
<dd><p>single positive number, where greater values indicate
heavier regularization. <code>cholesky_R2D2_b</code> has only to be specified if
<code>cholesky_U_prior="R2D2"</code>.</p></dd>


<dt id="arg-cholesky-r-d-tol">cholesky_R2D2_tol<a class="anchor" aria-label="anchor" href="#arg-cholesky-r-d-tol"></a></dt>
<dd><p>Minimum number that a parameter draw of one of the
shrinking parameters of the R2D2 prior can take. Prevents numerical issues
that can appear when strong shrinkage is enforced if chosen to be greater
than zero. <code>cholesky_R2D2_tol</code> has only to be specified if
<code>cholesky_U_prior="R2D2"</code>.</p></dd>


<dt id="arg-cholesky-ng-a">cholesky_NG_a<a class="anchor" aria-label="anchor" href="#arg-cholesky-ng-a"></a></dt>
<dd><p>(Single) positive real number. The value is interpreted
as the concentration parameter for the local scales. Smaller values enforce
heavier shrinkage. A matrix of dimension <code>c(s,2)</code> specifies a discrete
hyperprior, where the first column contains s support points and the second
column contains the associated prior probabilities. <code>cholesky_NG_a</code> has only
to be specified if <code>cholesky_U_prior="NG"</code>.</p></dd>


<dt id="arg-cholesky-ng-b">cholesky_NG_b<a class="anchor" aria-label="anchor" href="#arg-cholesky-ng-b"></a></dt>
<dd><p>(Single) positive real number. The value indicates the
shape parameter of the inverse gamma prior on the global scales.
<code>cholesky_NG_b</code> has only to be specified if <code>cholesky_U_prior="NG"</code>.</p></dd>


<dt id="arg-cholesky-ng-c">cholesky_NG_c<a class="anchor" aria-label="anchor" href="#arg-cholesky-ng-c"></a></dt>
<dd><p>(Single) positive real number. The value indicates the
scale parameter of the inverse gamma prior on the global scales.
Expert option would be to set the scale parameter proportional to NG_a. E.g.
in the case where a discrete hyperprior for NG_a is chosen, a desired
proportion of let's say 0.2 is achieved by setting NG_c="0.2a" (character
input!). <code>cholesky_NG_c</code> has only to be specified if
<code>cholesky_U_prior="NG"</code>.</p></dd>


<dt id="arg-cholesky-ng-tol">cholesky_NG_tol<a class="anchor" aria-label="anchor" href="#arg-cholesky-ng-tol"></a></dt>
<dd><p>Minimum number that a parameter draw of one of the
shrinking parameters of the normal-gamma prior can take. Prevents numerical
issues that can appear when strong shrinkage is enforced if chosen to be
greater than zero. <code>cholesky_NG_tol</code> has only to be specified if
<code>cholesky_U_prior="NG"</code>.</p></dd>


<dt id="arg-cholesky-ssvs-c-">cholesky_SSVS_c0<a class="anchor" aria-label="anchor" href="#arg-cholesky-ssvs-c-"></a></dt>
<dd><p>single positive number indicating the (unscaled)
standard deviation of the spike component. <code>cholesky_SSVS_c0</code> has only
to be specified if <code>choleksy_U_prior="SSVS"</code>.
It should be that \(SSVS_{c0}
  \ll SSVS_{c1}\)!</p></dd>


<dt id="arg-cholesky-ssvs-c-">cholesky_SSVS_c1<a class="anchor" aria-label="anchor" href="#arg-cholesky-ssvs-c-"></a></dt>
<dd><p>single positive number indicating the (unscaled)
standard deviation of the slab component. <code>cholesky_SSVS_c1</code> has only
to be specified if <code>choleksy_U_prior="SSVS"</code>. It should be that
\(SSVS_{c0} \ll SSVS_{c1}\)!</p></dd>


<dt id="arg-cholesky-ssvs-p">cholesky_SSVS_p<a class="anchor" aria-label="anchor" href="#arg-cholesky-ssvs-p"></a></dt>
<dd><p>Either a single positive number in the range <code>(0,1)</code>
indicating the (fixed) prior inclusion probability of each coefficient. Or
numeric vector of length 2 with positive entries indicating the shape
parameters of the Beta distribution. In that case a Beta hyperprior is
placed on the prior inclusion probability. <code>cholesky_SSVS_p</code> has only to be
specified if <code>choleksy_U_prior="SSVS"</code>.</p></dd>


<dt id="arg-cholesky-hmp-lambda-">cholesky_HMP_lambda3<a class="anchor" aria-label="anchor" href="#arg-cholesky-hmp-lambda-"></a></dt>
<dd><p>numeric vector of length 2. Both entries must be
positive. The first indicates the shape and the second the rate of the Gamma
hyperprior on the contemporaneous coefficients. <code>cholesky_HMP_lambda3</code> has
only to be specified if <code>choleksy_U_prior="HMP"</code>.</p></dd>


<dt id="arg-cholesky-normal-sds">cholesky_normal_sds<a class="anchor" aria-label="anchor" href="#arg-cholesky-normal-sds"></a></dt>
<dd><p>numeric vector of length \(\frac{M^2-M}{2}\),
indicating the prior variances for the free off-diagonal elements in
\(U\). A single number will be recycled accordingly! Must be positive.
<code>cholesky_normal_sds</code> has only to be specified if
<code>choleksy_U_prior="normal"</code>.</p></dd>


<dt id="arg-expert-sv-offset">expert_sv_offset<a class="anchor" aria-label="anchor" href="#arg-expert-sv-offset"></a></dt>
<dd><p>... Do not use!</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>logical indicating whether informative output should be omitted.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Do not use!</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Object of class <code>bayesianVARs_prior_sigma</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>bvar</code> offers two different specifications for the errors: The user can
choose between a factor stochastic volatility structure or a cholesky
stochastic volatility structure. In both cases the disturbances
\(\boldsymbol{\epsilon}_t\) are assumed to follow a \(M\)-dimensional
multivariate normal distribution with zero mean and variance-covariance matrix
\(\boldsymbol{\Sigma}_t\). In case of the cholesky specification
\(\boldsymbol{\Sigma}_t = \boldsymbol{U}^{\prime -1} \boldsymbol{D}_t
\boldsymbol{U}^{-1}\), where \(\boldsymbol{U}^{-1}\) is upper unitriangular (with ones on
the diagonal). The diagonal matrix \(\boldsymbol{D}_t\) depends upon latent
log-variances, i.e. \(\boldsymbol{D}_t=diag(exp(h_{1t}),\dots, exp(h_{Mt})\). The
log-variances follow a priori independent autoregressive processes
\(h_{it}\sim N(\mu_i + \phi_i(h_{i,t-1}-\mu_i),\sigma_i^2)\) for
\(i=1,\dots,M\). In case of the factor structure,
\(\boldsymbol{\Sigma}_t = \boldsymbol{\Lambda} \boldsymbol{V}_t \boldsymbol{\Lambda}^\prime +
\boldsymbol{G}_t\). The diagonal matrices \(\boldsymbol{V}_t\) and
\(\boldsymbol{G}_t\) depend upon latent log-variances, i.e.
\(\boldsymbol{G}_t=diag(exp(h_{1t}),\dots, exp(h_{Mt})\) and
\(\boldsymbol{V}_t=diag(exp(h_{M+1,t}),\dots, exp(h_{M+r,t})\). The log-variances
follow a priori independent autoregressive processes \(h_{it}\sim N(\mu_i +
\phi_i(h_{i,t-1}-\mu_i),\sigma_i^2)\) for \(i=1,\dots,M\) and
\(h_{M+j,t}\sim N(\phi_ih_{M+j,t-1},\sigma_{M+j}^2)\) for \(j=1,\dots,r\).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kastner, G. (2019). Sparse Bayesian Time-Varying Covariance
Estimation in Many Dimensions <em>Journal of Econometrics</em>, <b>210</b>(1),
98–115, <a href="https://doi.org/10.1016/j.jeconom.2018.11.007" class="external-link">doi:10.1016/j.jeconom.2018.11.007</a></p>
<p>Kastner, G., Frühwirth-Schnatter, S., and Lopes, H.F. (2017).
Efficient Bayesian Inference for Multivariate Factor Stochastic Volatility
Models. <em>Journal of Computational and Graphical Statistics</em>,
<b>26</b>(4), 905–917, <a href="https://doi.org/10.1080/10618600.2017.1322091" class="external-link">doi:10.1080/10618600.2017.1322091</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="specify_prior_phi.html">specify_prior_phi()</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Access a subset of the usmacro_growth dataset</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">usmacro_growth</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GDPC1"</span>, <span class="st">"CPIAUCSL"</span>, <span class="st">"FEDFUNDS"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># examples with stochastic volatility (heteroscedasticity) -----------------</span></span></span>
<span class="r-in"><span><span class="co"># factor-decomposition with 2 factors and colwise normal-gamma prior on the loadings</span></span></span>
<span class="r-in"><span><span class="va">sigma_factor_cng_sv</span> <span class="op">&lt;-</span> <span class="fu">specify_prior_sigma</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, type <span class="op">=</span> <span class="st">"factor"</span>,</span></span>
<span class="r-in"><span>factor_factors <span class="op">=</span> <span class="fl">2L</span>, factor_priorfacloadtype <span class="op">=</span> <span class="st">"colwiseng"</span>, factor_heteroskedastic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Since argument 'type' is specified with 'factor', all arguments starting with 'cholesky_' are being ignored.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># cholesky-decomposition with Dirichlet-Laplace prior on U</span></span></span>
<span class="r-in"><span><span class="va">sigma_cholesky_dl_sv</span> <span class="op">&lt;-</span> <span class="fu">specify_prior_sigma</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, type <span class="op">=</span> <span class="st">"cholesky"</span>,</span></span>
<span class="r-in"><span>cholesky_U_prior <span class="op">=</span> <span class="st">"DL"</span>, cholesky_DL_a <span class="op">=</span> <span class="fl">0.5</span>, cholesky_heteroscedastic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Since argument 'type' is specified with 'cholesky', all arguments starting with 'factor_' are being ignored.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># examples without stochastic volatility (homoscedasticity) ----------------</span></span></span>
<span class="r-in"><span><span class="co"># factor-decomposition with 2 factors and colwise normal-gamma prior on the loadings</span></span></span>
<span class="r-in"><span><span class="va">sigma_factor_cng</span> <span class="op">&lt;-</span> <span class="fu">specify_prior_sigma</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, type <span class="op">=</span> <span class="st">"factor"</span>,</span></span>
<span class="r-in"><span>factor_factors <span class="op">=</span> <span class="fl">2L</span>, factor_priorfacloadtype <span class="op">=</span> <span class="st">"colwiseng"</span>,</span></span>
<span class="r-in"><span>factor_heteroskedastic <span class="op">=</span> <span class="cn">FALSE</span>, factor_priorhomoskedastic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Since argument 'type' is specified with 'factor', all arguments starting with 'cholesky_' are being ignored.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cannot do deep factor_interweaving if (some) factor_factors are homoskedastic. Setting 'factor_interweaving' to 3.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># cholesky-decomposition with Horseshoe prior on U</span></span></span>
<span class="r-in"><span><span class="va">sigma_cholesky_dl</span> <span class="op">&lt;-</span> <span class="fu">specify_prior_sigma</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, type <span class="op">=</span> <span class="st">"cholesky"</span>,</span></span>
<span class="r-in"><span>cholesky_U_prior <span class="op">=</span> <span class="st">"HS"</span>, cholesky_heteroscedastic <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Since argument 'type' is specified with 'cholesky', all arguments starting with 'factor_' are being ignored.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Argument 'cholesky_priorhomoscedastic' not specified. Setting both shape and rate of inverse gamma prior equal to 0.01.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Estimate model with your prior configuration of choice</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="bvar.html">bvar</a></span><span class="op">(</span><span class="va">data</span>, prior_sigma <span class="op">=</span> <span class="va">sigma_factor_cng_sv</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luis Gruber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

